import{b as W,d as L,n as q,i as A,e as k,t as z,f as J,h as $,k as M,s as Y,m as X,o as N,S as Z,R as S,p as ee,q as te,P as O,r as x,j as n,L as se}from"./index-c680d4e0.js";var re=function(c){W(o,c);function o(i,t){var e;return e=c.call(this)||this,e.client=i,e.options=t,e.trackedProps=[],e.selectError=null,e.bindMethods(),e.setOptions(t),e}var r=o.prototype;return r.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},r.onSubscribe=function(){this.listeners.length===1&&(this.currentQuery.addObserver(this),D(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},r.onUnsubscribe=function(){this.listeners.length||this.destroy()},r.shouldFetchOnReconnect=function(){return I(this.currentQuery,this.options,this.options.refetchOnReconnect)},r.shouldFetchOnWindowFocus=function(){return I(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},r.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},r.setOptions=function(t,e){var a=this.options,s=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(t),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=a.queryKey),this.updateQuery();var l=this.hasListeners();l&&G(this.currentQuery,s,this.options,a)&&this.executeFetch(),this.updateResult(e),l&&(this.currentQuery!==s||this.options.enabled!==a.enabled||this.options.staleTime!==a.staleTime)&&this.updateStaleTimeout();var u=this.computeRefetchInterval();l&&(this.currentQuery!==s||this.options.enabled!==a.enabled||u!==this.currentRefetchInterval)&&this.updateRefetchInterval(u)},r.getOptimisticResult=function(t){var e=this.client.defaultQueryObserverOptions(t),a=this.client.getQueryCache().build(this.client,e);return this.createResult(a,e)},r.getCurrentResult=function(){return this.currentResult},r.trackResult=function(t,e){var a=this,s={},l=function(f){a.trackedProps.includes(f)||a.trackedProps.push(f)};return Object.keys(t).forEach(function(u){Object.defineProperty(s,u,{configurable:!1,enumerable:!0,get:function(){return l(u),t[u]}})}),(e.useErrorBoundary||e.suspense)&&l("error"),s},r.getNextResult=function(t){var e=this;return new Promise(function(a,s){var l=e.subscribe(function(u){u.isFetching||(l(),u.isError&&(t!=null&&t.throwOnError)?s(u.error):a(u))})})},r.getCurrentQuery=function(){return this.currentQuery},r.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},r.refetch=function(t){return this.fetch(L({},t,{meta:{refetchPage:t==null?void 0:t.refetchPage}}))},r.fetchOptimistic=function(t){var e=this,a=this.client.defaultQueryObserverOptions(t),s=this.client.getQueryCache().build(this.client,a);return s.fetch().then(function(){return e.createResult(s,a)})},r.fetch=function(t){var e=this;return this.executeFetch(t).then(function(){return e.updateResult(),e.currentResult})},r.executeFetch=function(t){this.updateQuery();var e=this.currentQuery.fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(q)),e},r.updateStaleTimeout=function(){var t=this;if(this.clearStaleTimeout(),!(A||this.currentResult.isStale||!k(this.options.staleTime))){var e=z(this.currentResult.dataUpdatedAt,this.options.staleTime),a=e+1;this.staleTimeoutId=setTimeout(function(){t.currentResult.isStale||t.updateResult()},a)}},r.computeRefetchInterval=function(){var t;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(t=this.options.refetchInterval)!=null?t:!1},r.updateRefetchInterval=function(t){var e=this;this.clearRefetchInterval(),this.currentRefetchInterval=t,!(A||this.options.enabled===!1||!k(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(function(){(e.options.refetchIntervalInBackground||J.isFocused())&&e.executeFetch()},this.currentRefetchInterval))},r.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},r.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},r.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},r.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},r.createResult=function(t,e){var a=this.currentQuery,s=this.options,l=this.currentResult,u=this.currentResultState,f=this.currentResultOptions,g=t!==a,v=g?t.state:this.currentQueryInitialState,_=g?this.currentResult:this.previousQueryResult,d=t.state,b=d.dataUpdatedAt,T=d.error,w=d.errorUpdatedAt,C=d.isFetching,m=d.status,F=!1,P=!1,y;if(e.optimisticResults){var U=this.hasListeners(),K=!U&&D(t,e),V=U&&G(t,a,e,s);(K||V)&&(C=!0,b||(m="loading"))}if(e.keepPreviousData&&!d.dataUpdateCount&&(_!=null&&_.isSuccess)&&m!=="error")y=_.data,b=_.dataUpdatedAt,m=_.status,F=!0;else if(e.select&&typeof d.data<"u")if(l&&d.data===(u==null?void 0:u.data)&&e.select===this.selectFn)y=this.selectResult;else try{this.selectFn=e.select,y=e.select(d.data),e.structuralSharing!==!1&&(y=$(l==null?void 0:l.data,y)),this.selectResult=y,this.selectError=null}catch(Q){M().error(Q),this.selectError=Q}else y=d.data;if(typeof e.placeholderData<"u"&&typeof y>"u"&&(m==="loading"||m==="idle")){var R;if(l!=null&&l.isPlaceholderData&&e.placeholderData===(f==null?void 0:f.placeholderData))R=l.data;else if(R=typeof e.placeholderData=="function"?e.placeholderData():e.placeholderData,e.select&&typeof R<"u")try{R=e.select(R),e.structuralSharing!==!1&&(R=$(l==null?void 0:l.data,R)),this.selectError=null}catch(Q){M().error(Q),this.selectError=Q}typeof R<"u"&&(m="success",y=R,P=!0)}this.selectError&&(T=this.selectError,y=this.selectResult,w=Date.now(),m="error");var H={status:m,isLoading:m==="loading",isSuccess:m==="success",isError:m==="error",isIdle:m==="idle",data:y,dataUpdatedAt:b,error:T,errorUpdatedAt:w,failureCount:d.fetchFailureCount,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>v.dataUpdateCount||d.errorUpdateCount>v.errorUpdateCount,isFetching:C,isRefetching:C&&m!=="loading",isLoadingError:m==="error"&&d.dataUpdatedAt===0,isPlaceholderData:P,isPreviousData:F,isRefetchError:m==="error"&&d.dataUpdatedAt!==0,isStale:E(t,e),refetch:this.refetch,remove:this.remove};return H},r.shouldNotifyListeners=function(t,e){if(!e)return!0;var a=this.options,s=a.notifyOnChangeProps,l=a.notifyOnChangePropsExclusions;if(!s&&!l||s==="tracked"&&!this.trackedProps.length)return!0;var u=s==="tracked"?this.trackedProps:s;return Object.keys(t).some(function(f){var g=f,v=t[g]!==e[g],_=u==null?void 0:u.some(function(b){return b===f}),d=l==null?void 0:l.some(function(b){return b===f});return v&&!d&&(!u||_)})},r.updateResult=function(t){var e=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!Y(this.currentResult,e)){var a={cache:!0};(t==null?void 0:t.listeners)!==!1&&this.shouldNotifyListeners(this.currentResult,e)&&(a.listeners=!0),this.notify(L({},a,t))}},r.updateQuery=function(){var t=this.client.getQueryCache().build(this.client,this.options);if(t!==this.currentQuery){var e=this.currentQuery;this.currentQuery=t,this.currentQueryInitialState=t.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))}},r.onQueryUpdate=function(t){var e={};t.type==="success"?e.onSuccess=!0:t.type==="error"&&!X(t.error)&&(e.onError=!0),this.updateResult(e),this.hasListeners()&&this.updateTimers()},r.notify=function(t){var e=this;N.batch(function(){t.onSuccess?(e.options.onSuccess==null||e.options.onSuccess(e.currentResult.data),e.options.onSettled==null||e.options.onSettled(e.currentResult.data,null)):t.onError&&(e.options.onError==null||e.options.onError(e.currentResult.error),e.options.onSettled==null||e.options.onSettled(void 0,e.currentResult.error)),t.listeners&&e.listeners.forEach(function(a){a(e.currentResult)}),t.cache&&e.client.getQueryCache().notify({query:e.currentQuery,type:"observerResultsUpdated"})})},o}(Z);function ie(c,o){return o.enabled!==!1&&!c.state.dataUpdatedAt&&!(c.state.status==="error"&&o.retryOnMount===!1)}function D(c,o){return ie(c,o)||c.state.dataUpdatedAt>0&&I(c,o,o.refetchOnMount)}function I(c,o,r){if(o.enabled!==!1){var i=typeof r=="function"?r(c):r;return i==="always"||i!==!1&&E(c,o)}return!1}function G(c,o,r,i){return r.enabled!==!1&&(c!==o||i.enabled===!1)&&(!r.suspense||c.state.status!=="error")&&E(c,r)}function E(c,o){return c.isStaleByTime(o.staleTime)}function ne(){var c=!1;return{clearReset:function(){c=!1},reset:function(){c=!0},isReset:function(){return c}}}var ae=S.createContext(ne()),le=function(){return S.useContext(ae)};function ce(c,o,r){return typeof o=="function"?o.apply(void 0,r):typeof o=="boolean"?o:!!c}function oe(c,o){var r=S.useRef(!1),i=S.useState(0),t=i[1],e=ee(),a=le(),s=e.defaultQueryObserverOptions(c);s.optimisticResults=!0,s.onError&&(s.onError=N.batchCalls(s.onError)),s.onSuccess&&(s.onSuccess=N.batchCalls(s.onSuccess)),s.onSettled&&(s.onSettled=N.batchCalls(s.onSettled)),s.suspense&&(typeof s.staleTime!="number"&&(s.staleTime=1e3),s.cacheTime===0&&(s.cacheTime=1)),(s.suspense||s.useErrorBoundary)&&(a.isReset()||(s.retryOnMount=!1));var l=S.useState(function(){return new o(e,s)}),u=l[0],f=u.getOptimisticResult(s);if(S.useEffect(function(){r.current=!0,a.clearReset();var g=u.subscribe(N.batchCalls(function(){r.current&&t(function(v){return v+1})}));return u.updateResult(),function(){r.current=!1,g()}},[a,u]),S.useEffect(function(){u.setOptions(s,{listeners:!1})},[s,u]),s.suspense&&f.isLoading)throw u.fetchOptimistic(s).then(function(g){var v=g.data;s.onSuccess==null||s.onSuccess(v),s.onSettled==null||s.onSettled(v,null)}).catch(function(g){a.clearReset(),s.onError==null||s.onError(g),s.onSettled==null||s.onSettled(void 0,g)});if(f.isError&&!a.isReset()&&!f.isFetching&&ce(s.suspense,s.useErrorBoundary,[f.error,u.getCurrentQuery()]))throw f.error;return s.notifyOnChangeProps==="tracked"&&(f=u.trackResult(f,s)),f}function ue(c,o,r){var i=te(c,o,r);return oe(i,re)}const _e="_link_p9li9_1",he="_list_p9li9_1",de="_game__name_p9li9_3",fe="_game__descr_p9li9_12",pe="_game__list_p9li9_20",me="_game__item_p9li9_28",ge="_game__image_p9li9_46",ve="_game__text_wrapper_p9li9_55",ye="_game__genre_wrapper_p9li9_60",Re="_game__genre_text_p9li9_68",be="_allgames__section_p9li9_80",xe="_allgames__container_p9li9_87",Se="_allgames__title_p9li9_98",Oe="_game__top_p9li9_107",Qe="_game__class_p9li9_119",Ne="_button__showmore_p9li9_133",je="_game__item__small_p9li9_151",Ce="_game__image__small_p9li9_161",Ie="_game__name__small_p9li9_173",Ee="_platform__svg_p9li9_183",Te="_platform__item_p9li9_189",we="_platform__list_p9li9_199",p={link:_e,list:he,game__name:de,game__descr:fe,game__list:pe,game__item:me,game__image:ge,game__text_wrapper:ve,game__genre_wrapper:ye,game__genre_text:Re,allgames__section:be,allgames__container:xe,allgames__title:Se,game__top:Oe,game__class:Qe,button__showmore:Ne,game__item__small:je,game__image__small:Ce,game__name__small:Ie,platform__svg:Ee,platform__item:Te,platform__list:we},Fe=["всі ALL","безкоштовні FREE","мова MOBA","шутери SHOOTERS","лаунчери LAUNCHERS","mmorpg MMORPG","стратегії STRATEGY","файтинг FIGHTING","гонки RACING","виживання SURVIVAL ","онлайн ONLINE"],Pe=["спочатку нові","спочатку старі"],Ue="_filter__wrapper_1dhiu_1",Le="_button__list_1dhiu_5",Ae="_button__category_1dhiu_12",ke="_button__category_selected_1dhiu_30",$e="_filter__right_side_1dhiu_34",Me="_filter_sort_1dhiu_40",De="_filter__sorttitle_1dhiu_49",Ge="_filter__select_1dhiu_60",Be="_select__wrapper_1dhiu_78",Ke="_svg_1dhiu_90",Ve="_svg__open_1dhiu_104",He="_selected__text_1dhiu_110",We="_select__list_1dhiu_116",qe="_select__item_1dhiu_130",ze="_filter__buttonswrapper_1dhiu_143",Je="_filter__button_1dhiu_143",Ye="_filter__button__selected_1dhiu_171",Xe="_svg_filter_1dhiu_175",h={filter__wrapper:Ue,button__list:Le,button__category:Ae,button__category_selected:ke,filter__right_side:$e,filter_sort:Me,filter__sorttitle:De,filter__select:Ge,select__wrapper:Be,svg:Ke,svg__open:Ve,selected__text:He,select__list:We,select__item:qe,filter__buttonswrapper:ze,filter__button:Je,filter__button__selected:Ye,svg_filter:Xe},j="/miraplay_test_client/assets/icons-20933d6a.svg",B=({selectedCategory:c,setSelectedCategory:o,setSelectedOption:r,selectedOption:i,size:t,setSize:e})=>{const[a,s]=x.useState(!1);return n.jsxs("div",{className:h.filter__wrapper,children:[n.jsx("ul",{className:h.button__list,children:Fe.map(l=>n.jsx("li",{className:`${h.button__category} ${c===l.split(" ")[1]?h.button__category_selected:""}`,onClick:()=>o(l.split(" ")[1]),children:l.split(" ")[0]},l.split(" ")[0]))}),n.jsxs("div",{className:h.filter__right_side,children:[n.jsx("div",{className:h.filter_sort,children:n.jsxs("div",{className:h.filter__select,children:[n.jsx("h4",{className:h.filter__sorttitle,children:"Сортувати:"}),n.jsxs("div",{className:h.select__wrapper,onClick:()=>s(l=>!l),children:[n.jsx("svg",{className:`${h.svg} ${a&&h.svg__open}`,children:n.jsx("use",{href:j+"#icon-play"})}),n.jsx("p",{className:h.selected__text,children:i}),a&&n.jsx("ul",{className:h.select__list,children:Pe.filter(l=>l!==i).map(l=>n.jsx("li",{className:h.select__item,onClick:()=>r(l),children:l},l))})]})]})}),n.jsxs("div",{className:h.filter__buttonswrapper,children:[n.jsx("h5",{className:h.filter__sorttitle,children:"Розмір:"}),n.jsx("button",{className:`${h.filter__button} ${t?h.filter__button__selected:""}`,onClick:()=>e(!0),children:n.jsx("svg",{className:`${h.svg_filter} ${a&&h.svg__open}`,children:n.jsx("use",{href:j+"#icon-table"})})}),n.jsx("button",{className:`${h.filter__button} ${t?"":h.filter__button__selected}`,onClick:()=>e(!1),children:n.jsx("svg",{className:`${h.svg_filter} ${a&&h.svg__open}`,children:n.jsx("use",{href:j+"#icon-insert-template"})})})]})]})]})};B.propTypes={selectedCategory:O.string,setSelectedCategory:O.func,setSelectedOption:O.func,selectedOption:O.string,size:O.bool,setSize:O.func};const et=()=>{const[c,o]=x.useState("ALL"),[r,i]=x.useState(1),[t,e]=x.useState(!0),[a,s]=x.useState("спочатку нові"),[l,u]=x.useState([]),[f,g]=x.useState(0),{isLoading:v}=ue(["repoData",r,a,c],()=>fetch("https://api.miraplay.cloud/games/by_page",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:r,isFreshGamesFirst:a==="спочатку нові",genre:c==="ALL"?!1:c,gamesToShow:9})}).then(_=>_.json()).then(_=>(u(()=>[..._.games]),g(_.gamesListLength),_)));return n.jsx("section",{className:p.allgames__section,children:n.jsxs("div",{className:p.allgames__container,children:[n.jsx("h4",{className:p.allgames__title,children:"Всі ігри"}),n.jsx(B,{selectedCategory:c,setSelectedCategory:o,setSelectedOption:s,selectedOption:a,size:t,setSize:e}),n.jsx("ul",{className:p.game__list,children:l.map(_=>t?n.jsxs("li",{className:p.game__item,children:[n.jsx("img",{src:_.gameImage,alt:_.gameDescription,className:p.game__image}),n.jsxs("div",{className:p.game__text_wrapper,children:[n.jsx("h4",{className:p.game__name,children:_.commonGameName}),n.jsx("p",{className:p.game__descr,children:_.gameDescription.length>50?_.gameDescription.substring(0,110)+"...":_.gameDescription})]}),n.jsxs("div",{className:p.game__genre_wrapper,children:[_.inTop&&n.jsx("p",{className:p.game__top,children:"TOP"}),n.jsx("p",{className:p.game__genre_text,children:_.genre})]}),_.gameClass==="STANDART"&&n.jsx("p",{className:p.game__class,children:"БЕЗКОШТОВНО"}),n.jsx("ul",{className:p.platform__list,children:n.jsx("li",{className:p.platform__item,children:n.jsx("svg",{className:p.platform__svg,children:n.jsx("use",{href:j+"#steam"})})})})]},_._id):n.jsxs("li",{className:p.game__item__small,children:[n.jsx("img",{src:_.gameImage,alt:_.gameDescription,className:p.game__image__small}),n.jsx("h3",{className:p.game__name__small,children:_.commonGameName})]},_._id))}),l.length<f&&n.jsx("button",{className:p.button__showmore,onClick:_=>{_.preventDefault(),i(d=>d+1)},children:v?n.jsx(se,{}):n.jsx("div",{children:"Показати ще"})})]})})};export{et as default};
